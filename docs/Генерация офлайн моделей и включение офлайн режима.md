# Генерация офлайн моделей

Перед генерацией следует убедиться, что в репозитории свежие метаданные. В противном случае может возникнуть ошибка парсинга модели. Свежие метаданные нужно сгенерировать через flexberry-designer и положить в папку `vendor/flexberry`.

Чтобы сгенерировать офлайн сущности с помощью блупринта flexberry-application-offline, нужно воспользоваться командой следующего вида:

    ember g flexberry-application-offline app --metadata-dir=путь_к_метаданным --enable-offline=флаг_оффлайна_по_умолчанию --offline-db-name=имя_оффлайн_бд --skip-confirmation

Должны сгенерироваться:
- сериализаторы
- `offline-globals` с офлайн схемой
- `store`
- adapter `application-offline`

Нужно проследить, чтобы в аддоне были только сгенеренные сериализаторы и оффлайн схема. `store` и `application-offline` должны находиться в `dummy`.

# Включение офлайн режима

Для включения нужно:

- выключить флаг `setOnlineAvailable`; для этого переопределим offline-globals в tests/dummy/app/services/offline-globals.js следующим образом:

```javascript
      import OfflineGlobals from 'ember-flexberry-gis/services/offline-globals';
      export default OfflineGlobals.extend({
        init() {
          this._super(...arguments);
          this.setOnlineAvailable(false);
        }
      });
```

- в addon/services/local-storage.js проставить флаг `available`: true
- в environment.js проставить флаг `config.APP.offline.offlineEnabled` = true

После этого при запуске приложения должна появиться офлайн бд (можно увидеть в хроме  во вкладке Application и слева найти IndexedDB) и запросы к бэку не должны посылаться.
