{{#each layersExtend as |layerModel|}}
  {{#if (and layerModel.layer.visibility (not layerModel.layer.isDeleted))}}
    {{#if (eq layerModel.layer.type "group")}}
      {{flexberry-layerslegends
        layers=layerModel.layer.layers
      }}
    {{else}}
      {{#if layerModel.layer.legendCanBeDisplayed}}
        {{#if layerModel.haveSubLayers}}
          {{#each layerModel.subLayers as |subLayer|}}
            {{component (concat "legends/" layerModel.layer.type "-legend")
              layerName=layerModel.layer.name
              layerSettings=layerModel.layer.settingsAsObject
              showLayerName=layerModel.showLayerName
              lazyLoaded=false
              subLayerName=subLayer
            }}
          {{/each}}
        {{else}}
          {{component (concat "legends/" layerModel.layer.type "-legend")
            layerName=layerModel.layer.name
            layerSettings=layerModel.layer.settingsAsObject
            showLayerName=layerModel.showLayerName
            lazyLoaded=false
          }}
        {{/if}}
      {{/if}}
    {{/if}}
  {{/if}}
{{/each}}
